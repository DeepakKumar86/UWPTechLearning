name: Deploy Blazor WebAssembly to GitHub Pages

permissions:
  contents: write
  pages: write
  id-token: write

on:
  push:
    branches:
      - main
  workflow_dispatch:
        
      
  


jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '8.0.x'  # or 7.0.x

    - name: Restore dependencies
      run: dotnet restore

    - name: Build
      run: dotnet build --configuration Release

    - name: Publish Blazor project
      run: dotnet publish UWPTechLearning -c Release -o release --nologo

    - name: Add .nojekyll (to allow folders starting with _)
      run: touch release/wwwroot/.nojekyll

    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: release/wwwroot


# name: CI CD deployment

# on:
#   push: 
#    branches: [main]
#   workflow_dispatch:
    
#  permissions:
#   contents: write
#   # id-token: write
#   # pull-requests: write

# jobs:

#     build_and_deploy:
#       runs-on: ubuntu-latest

#       steps:
#       - name: Checkout code
#         uses: actions/checkout@v2

#       - name: Set up Node.js
#         uses: actions/setup-node@v2
#         with:
#           node-version: '16'
#       - name: Install dependencies
#         run: npm install
#       - name: Build Projetc
#         run: npm run build

#       - name: Deploy to Azure Static Web Apps
#         id: deploy-to-azure-static-web-apps
#         uses: Azure/static-web-apps-deploy@v1
#         with:
          
#           azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
#           action: 'upload'
#           app_location: '/'
#           output_location: 'build'
#           api_location: 'api'
#         env:
#           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#           AZURE_STATIC_WEB_APPS_API_TOKEN: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
#       # - uses: Azure/static-web-apps-deploy@v1
#       #   with:
#       #     azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
#       #     action: 'upload'
#       #     app_location: '/'
#       #     output_location: 'build'
#       #     api_location: 'api'
#       #   env:
#       #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       #     AZURE_STATIC_WEB_APPS_API_TOKEN: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
      
    

       
      

  
 
  
             
